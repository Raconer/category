<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ecommerce.category.repository.mapper.CategoryMapper">
    <select id="findByCategoryInfo" parameterType="Long" resultType="CategoryVo">
        SELECT  c1.id,
                c1.name,
                c1.parent,
                c1.sort,
                c1.reg_date,
                count(c2.id) as childCnt
        FROM category c1 
        LEFT JOIN category c2 ON c2.parent = c1.id 
        WHERE c1.parent = #{parent} 
        group by c1.id, c2.parent;
    </select>
</mapper>
